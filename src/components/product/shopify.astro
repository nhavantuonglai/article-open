---
import { fetchProducts } from '~/utils/shopify';
import Button from '~/components/ui/button.astro';

const products = await fetchProducts();
---

<section class="relative mx-auto max-w-7xl">
	<div class="mb-6 md:mb-12 md:px-6 px-4 text-default">
		<div class="md:max-w-sm">
			<h2 class="font-bold font-heading mb-6 leading-tighter tracking-tighter md:text-5xl text-4xl">Sản phẩm mới</h2>
		</div>

		<div class="mb-6 gap-6 grid lg:grid-cols-4 md:grid-cols-2 row-gap-5">
			{products.map((product) => (
				<article class="transition mb-6" key={product.id} >

					<img 
						alt={product.title} 
						src={product.images[0]?.src} 
						class="shadow-lg bg-gray-400 dark:bg-slate-700 rounded-lg mb-6" 
						title={product.title} 
						decoding="async" 
						loading="lazy" 
						style="object-fit:cover; object-position:center; border-radius: 8px;"
					/>

					<h3 class="font-bold text-xl font-heading leading-tight mb-6 sm:text-2xl">
						{product.title}
					</h3>

					<p class="text-muted dark:text-slate-400 text-justify text-lg">
						{product.body_html ? product.body_html : 'Không có mô tả'}
					</p>

					<Button href={product.permalink} 
					target="_blank" class="text-lg font-semibold w-full mb-6">
						{product.variants[0]?.price ? product.variants[0].price + ' USD' : 'Giá không có sẵn'}
					</Button>

				</article>
			))}
		</div>

	</div>

</section>